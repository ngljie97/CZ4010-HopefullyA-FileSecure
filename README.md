# CZ4010 - Applied Cryptography Project
### Group: HopefullyA (Ng Li Jie & Joel Ng)

<br/>

## About the project
Project Topic #1 : Secure File-Sharing platform with untrusted Intermediary.

<br/>

  ### Designs and Motivations
  Since we do not know where the server is and if it is secured, our platform secure the files before it leaves the client computer.

  - Authentication and database using Firebase (by Google).
  - We make use of AES to encrypt the file, and RSA to encrypt the key to AES.
  - File is splice and parity file is generated for availability.


  #### -- File Confidentiality --
  To achieve this, we make use of two cryptographic algorithms, AES and RSA.

  The file server is untrusted hence we do not want to share any information with it. Instead we store information that drives the operation in a third-party database (Firebase) which is run by a reputable company.

  The file are encrypted with AES (MODE_EAX) and the key is hashed and stored in Firebase for verification, at the same time keeping the key confidential.

  When someone wants to download the file, we need to share the key with the other party. Again, we avoid transmitting it through the file server and instead, we used the Public Key Cryptography Algorithm - RSA, to encrypt the key for the AES, before transmitting it to the party. This way, only the approved party can decrypt and make use of the key to decrypt the encrypted file shared.

  #### -- File Integrity --
  The choice of mode for the AES cipher is due to its capability to provide a hash of the encrypted file.

  #### -- File Fault Tolerance --
  Before encryption is done, the original file is split into 2 parts of equal size, and then a 3rd file is computed as the parity file (bit-wise XOR operation). This way if any one of the parts becomes corrupted, the file can still be reconstructed with the other 2 files.

  #### -- Authentication and Non-repudiation --
  To use the system, the users must first register for account through the client app, this process also generates and store a pair of public and private key. The former is stored on Firebase, and latter in the user's personal computer.

  Every operation is recorded in the Firebase database with their Unique Identifier (generated by Firebase during account creation) and time stamp.

  The user's account also has certain password constraint to ensure a sufficiently strong password is used to create their account.

### Code and implementations
 - External Library used:
   - Crypto (pycryptodome) : AES; SHA512; PBKDF2
   - cryptography.hazmat (Cryptography) : RSA(2048); SHA256
   - tqdm : Progress bar UI
   - PrettyTable : Tabularize the list display (UI)


## Getting started
- Setting up the server
  - Navigate to \server_side and copy the contents to your desired location in the server machine (file sharing host).

  - Running the server (Admin or sudo required)
    ```
    python3 server_app.py
    ```

- Setting up the client
  - Navigate to backend\globals.py and change the 'SERVER_IP' and 'SERVER_PORT' to the correct IP and Port the file server is listening on.
  - Running the client (from project root)
    ```
    python3 client_app.py
    ```

#### Directory stucture
- backend\  : containing code of all the program logic and solutions.
  - backend\implementations\ : Codes of our implementation of various tools used in our program.
  - backend\controllers\  : Python files meant for interaction between objects/classes.
- frontend\ : containing code meant for displaying the front facing user interface.

#### Export project dependencies
```
pip3 freeze > requirements.txt
```
#### Installing project dependencies
```
# for client
pip3 install -r requirements.txt

Due to some error with pyrebase and pycryptodome, have to install pyrebase, remove the pycryptodome manually (pip uninstall) and install pycryptodome again.

# server only requires tqdm library
pip install tqdm
```
<br/>
<hr/>
<br/>

## Changelog

### V1.1.0
><ol>
><li>Usability Improvements.</li>
><li>Code clean up.</li>
></ol>

### V1.0.0
><ol>
><li>Uploading and downloading of file completed.</li>
><li>Removed release script. Server-side app is now self contained into one single python file.</li>
><li>Code clean up.</li>
><li>Removed unused files and folders.</li>
></ol>

### V0.2.0
><ol>
><li>Sending and downloading file was previously added by Joel</li>
><li>Added release script (release.py) which will copy files for server and client release respectively into the release folder.</li>
><li>Other bug fixes here and there.</li>
></ol>

### V0.1.4:
><ol>
><li>User can now exchange file password (in plaintext for now. Encryption to be done with asymmetric encryption, tentatively RSA)</li>
><li>Database entries now contains more information required for the file/password exchange.</li>
><li>Added functionality of computing hash of the encryption key which will be stored in database. Required for validation.</li>
></ol>

### V0.1.3:
><ol>
><li>Added data_controller for communication with Firebase database.</li>
><li>Initial integration to include insertion of database entries.</li>
><li>Changes to global variables to cater for more variables sharing</li>
></ol>

### V0.1.2:
><ol>
><li>Added IS_AUTHENTICATED bool expression to globals variable.</li>
><li>Added MAX_LOGIN_ATTEMPTS to globals as well for easier updating.</li>
><li>Updated feature to sign out in auth_controller. Now clears the the AUTH_USER and sets IS_AUTHENTICATED to False.</li>
><ol>
><li>Updated the signin function to make use of the new global variables.</li>
></ol>
><li>Added the option to sign out in client_view.</li>
></ol>

### V0.1.1:
><ol>
><li>Updated directory structure. Separate controllers and implementaion classes.</li>
><li>RAID and AES implementation completed.</li>
></ol>

### V0.1.0:
><ol>
><li>Initial drafting of code skeletal structure and code testing classes. </li>
><li>Lots of trial-and-error steps ommited from the changelog.</li>
></ol>